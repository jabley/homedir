#! /bin/bash

# Recursively find and fetch git repos. Requires (GNU) parallel to run

CUR_DIR=$(pwd);

function fetch() {
   pushd "$(dirname "$CUR_DIR/$1")" > /dev/null || return
   git fetch --prune
}

export -f fetch

find "$CUR_DIR" -name .git -type d | parallel -a - fetch

date +%Y-%m-%dT%H:%M:%S%z
